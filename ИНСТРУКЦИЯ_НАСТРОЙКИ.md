# ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —á–∞—Å—Ç–∏—á–Ω–æ

## –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ:
- ‚úÖ –§–∞–π–ª `.env.local` —Å–æ–∑–¥–∞–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ URL –∏ –∫–ª—é—á Supabase –¥–æ–±–∞–≤–ª–µ–Ω—ã
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Supabase —Ä–∞–±–æ—Ç–∞–µ—Ç

## ‚ö†Ô∏è –í–∞–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∏–ø –∫–ª—é—á–∞

–í–∞—à –∫–ª—é—á –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `sb_secret_`, —á—Ç–æ –ø–æ—Ö–æ–∂–µ –Ω–∞ **service role key**.

–î–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Next.js –Ω—É–∂–µ–Ω **anon public key** (–æ–±—ã—á–Ω–æ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `eyJ...`).

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
1. –ó–∞–π–¥–∏—Ç–µ –≤ Supabase Dashboard: https://supabase.com/dashboard/project/pklwfuyxumtjbgyqlxsf
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ: **Settings ‚Üí API**
3. –ù–∞–π–¥–∏—Ç–µ —Å–µ–∫—Ü–∏—é **Project API keys**
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **anon public** key (–Ω–µ service_role!)
5. –û–±–Ω–æ–≤–∏—Ç–µ `.env.local`:

```env
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

### 2. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —à–∞–≥!** SQL —Å–∫—Ä–∏–ø—Ç—ã –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Ä—É—á–Ω—É—é –≤ —Ç–∞–∫–æ–º –ø–æ—Ä—è–¥–∫–µ:

1. –û—Ç–∫—Ä–æ–π—Ç–µ **SQL Editor**: https://supabase.com/dashboard/project/pklwfuyxumtjbgyqlxsf/sql/new
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã –ø–æ –æ—á–µ—Ä–µ–¥–∏ (—Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ ‚Üí –≤—Å—Ç–∞–≤–∏—Ç—å –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä ‚Üí **Run**):
   - `scripts/001-create-tables.sql` ‚Äî –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
   - –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –∏–∑ –ø–∞–ø–∫–∏ `scripts/` –ø–æ –Ω–æ–º–µ—Ä–∞–º (002, 003, ‚Ä¶), –µ—Å–ª–∏ –æ–Ω–∏ —É –≤–∞—Å –µ—Å—Ç—å

**–ï—Å–ª–∏ –ø–æ—è–≤–∏–ª–∞—Å—å –æ—à–∏–±–∫–∞ ¬´Could not find the table public.user_friends¬ª:**

3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –¥—Ä—É–∑–µ–π –∏ —Å–æ–æ–±—â–µ–Ω–∏–π:
   - –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `scripts/039-friends-messages-online.sql`
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å SQL, –≤—Å—Ç–∞–≤—å—Ç–µ –≤ SQL Editor –≤ Supabase, –Ω–∞–∂–º–∏—Ç–µ **Run**
4. –û–±–Ω–æ–≤–∏—Ç–µ –∫–µ—à —Å—Ö–µ–º—ã –≤ Supabase: **Settings ‚Üí API** ‚Üí –∫–Ω–æ–ø–∫–∞ **Reload schema** (–∏–ª–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç). –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Ç–∞–±–ª–∏—Ü–∞ `user_friends` –±—É–¥–µ—Ç –≤–∏–¥–Ω–∞ API.

**–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è (–∏–≥—Ä—ã, –≤–µ–¥—É—â–∏–π, ¬´–ö—Ç–æ —è?¬ª, –ø—Ä–µ–º–∏—É–º):** –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `scripts/041-achievements-fixes-and-whoami.sql` –ø–æ—Å–ª–µ —Å–∫—Ä–∏–ø—Ç–∞ 036. –ó–∞—Ç–µ–º —Å–Ω–æ–≤–∞ **Reload schema**.

### 3. –í–∫–ª—é—á–∏—Ç–µ Realtime

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ: https://supabase.com/dashboard/project/pklwfuyxumtjbgyqlxsf/database/replication
2. –í–∫–ª—é—á–∏—Ç–µ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—é –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —Ç–∞–±–ª–∏—Ü (–Ω–∞–∂–º–∏—Ç–µ —Ç—É–º–±–ª–µ—Ä):
   - ‚úÖ `game_rooms`
   - ‚úÖ `game_players`
   - ‚úÖ `chat_messages`
   - ‚úÖ `player_characteristics`
   - ‚úÖ `votes`

### 4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Authentication

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ: https://supabase.com/dashboard/project/pklwfuyxumtjbgyqlxsf/auth/url-configuration
2. –í **Redirect URLs** –¥–æ–±–∞–≤—å—Ç–µ:
   ```
   http://localhost:3000/**
   http://localhost:3000/auth/callback
   ```
3. –í **Site URL** —É–∫–∞–∂–∏—Ç–µ: `http://localhost:3000`

### 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

```bash
node check-connection.js
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å: ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç! –¢–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã.

### 6. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å (Ctrl+C)
# –ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞:
pnpm dev
```

---

## –ë—ã—Å—Ç—Ä—ã–µ —Å—Å—ã–ª–∫–∏:

- **SQL Editor**: https://supabase.com/dashboard/project/pklwfuyxumtjbgyqlxsf/sql/new
- **Realtime**: https://supabase.com/dashboard/project/pklwfuyxumtjbgyqlxsf/database/replication
- **API Keys**: https://supabase.com/dashboard/project/pklwfuyxumtjbgyqlxsf/settings/api
- **Auth Settings**: https://supabase.com/dashboard/project/pklwfuyxumtjbgyqlxsf/auth/url-configuration

---

## 7. –û–ø–ª–∞—Ç–∞ (–ø—Ä–µ–º–∏—É–º-–ø–æ–¥–ø–∏—Å–∫–∞)

–í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **Yandex Pay**. –ß—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å –ø—Ä–∏—ë–º –ø–ª–∞—Ç–µ–∂–µ–π:

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –º–∞–≥–∞–∑–∏–Ω –≤ [Yandex Pay](https://console.pay.yandex.ru) –∏ –ø–æ–ª—É—á–∏—Ç–µ API-–∫–ª—é—á –∏ Merchant ID.
2. –î–æ–±–∞–≤—å—Ç–µ –≤ `.env.local` –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: `PAYMENT_PROVIDER=yandex-pay`, `YANDEX_PAY_API_KEY`, `NEXT_PUBLIC_YANDEX_PAY_MERCHANT_ID`, `YANDEX_PAY_SANDBOX`, `NEXT_PUBLIC_APP_URL`.
3. –í –∫–æ–Ω—Å–æ–ª–∏ Yandex Pay —É–∫–∞–∂–∏—Ç–µ Callback URL (–≤–∞—à –¥–æ–º–µ–Ω; –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ ‚Äî URL –æ—Ç ngrok).

**–ü–æ–¥—Ä–æ–±–Ω–æ:** —Å–º. —Ñ–∞–π–ª [docs/–û–ü–õ–ê–¢–ê_–í_–ü–†–ò–õ–û–ñ–ï–ù–ò–ò.md](docs/–û–ü–õ–ê–¢–ê_–í_–ü–†–ò–õ–û–ñ–ï–ù–ò–ò.md) ‚Äî –∫–∞–∫–æ–π —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –∫–∞–∫ –µ–≥–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å.

---

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ! üöÄ
