# üöÄ –£–ª—É—á—à–µ–Ω–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã –∫–∞–º–µ—Ä—ã/–º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ –¥–µ–ø–ª–æ—é

## üìπ –£–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –≤–∏–¥–µ–æ –∏ –∞—É–¥–∏–æ

### 1. –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∏ –±–∏—Ç—Ä–µ–π—Ç

**–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ 640x480
- –ù–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è –±–∏—Ç—Ä–µ–π—Ç–∞
- –ù–µ—Ç –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ø–æ–¥ —Å–∫–æ—Ä–æ—Å—Ç—å —Å–µ—Ç–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

```typescript
// hooks/use-webrtc.ts - —É–ª—É—á—à–µ–Ω–Ω—ã–µ constraints –¥–ª—è –≤–∏–¥–µ–æ
const videoConstraints: MediaTrackConstraints | boolean = requestVideo
  ? {
      width: { ideal: 1280, max: 1920 },
      height: { ideal: 720, max: 1080 },
      frameRate: { ideal: 30, max: 60 },
      facingMode: "user",
      ...(mediaSettings?.cameraDeviceId && { deviceId: { ideal: mediaSettings.cameraDeviceId } }),
    }
  : false

// –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ - –±–æ–ª–µ–µ –Ω–∏–∑–∫–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ
const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)
const videoConstraints = isMobile
  ? {
      width: { ideal: 640, max: 1280 },
      height: { ideal: 480, max: 720 },
      frameRate: { ideal: 24, max: 30 },
      facingMode: "user",
    }
  : {
      width: { ideal: 1280, max: 1920 },
      height: { ideal: 720, max: 1080 },
      frameRate: { ideal: 30, max: 60 },
      facingMode: "user",
    }
```

### 2. –£–ª—É—á—à–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞—É–¥–∏–æ

**–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- –ë–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ echoCancellation –∏ noiseSuppression
- –ù–µ—Ç autoGainControl
- –ù–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–∞—á–µ—Å—Ç–≤–∞ –∞—É–¥–∏–æ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

```typescript
// –£–ª—É—á—à–µ–Ω–Ω—ã–µ constraints –¥–ª—è –∞—É–¥–∏–æ
const audioConstraints: MediaTrackConstraints | boolean = requestAudio
  ? {
      echoCancellation: true,
      noiseSuppression: true,
      autoGainControl: true,
      sampleRate: 48000, // –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π sample rate –¥–ª—è WebRTC
      channelCount: { ideal: 1, max: 2 }, // –ú–æ–Ω–æ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ç—Ä–∞—Ñ–∏–∫–∞
      ...(mediaSettings?.microphoneDeviceId && { deviceId: { ideal: mediaSettings.microphoneDeviceId } }),
    }
  : false
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∏—Ç—Ä–µ–π—Ç–∞ —á–µ—Ä–µ–∑ RTCRtpSender

**–î–æ–±–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è stream:**

```typescript
// –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è peer connection –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–∫–æ–≤
const sender = peerConnection.getSenders().find(s => s.track?.kind === 'video')
if (sender) {
  const params = sender.getParameters()
  if (!params.encodings) {
    params.encodings = [{}]
  }
  params.encodings[0].maxBitrate = 2500000 // 2.5 Mbps –¥–ª—è HD
  params.encodings[0].scaleResolutionDownBy = 1
  await sender.setParameters(params)
}
```

---

## üåê –£–ª—É—á—à–µ–Ω–∏—è –¥–ª—è production –¥–µ–ø–ª–æ—è

### 1. TURN —Å–µ—Ä–≤–µ—Ä—ã (–∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è NAT traversal)

**–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ STUN —Å–µ—Ä–≤–µ—Ä—ã
- –ù–µ —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑ —Å—Ç—Ä–æ–≥–∏–µ NAT (–º–Ω–æ–≥–∏–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Å–µ—Ç–∏)
- –ù–µ—Ç fallback –Ω–∞ TURN

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

```typescript
// lib/webrtc/peer-connection.ts
const getRTCConfiguration = (): RTCConfiguration => {
  const config: RTCConfiguration = {
    iceServers: [
      // STUN —Å–µ—Ä–≤–µ—Ä—ã (–ø—É–±–ª–∏—á–Ω—ã–µ, –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ)
      {
        urls: [
          "stun:stun.l.google.com:19302",
          "stun:stun1.l.google.com:19302",
          "stun:stun2.l.google.com:19302",
        ],
      },
    ],
  }

  // –î–æ–±–∞–≤–∏—Ç—å TURN —Å–µ—Ä–≤–µ—Ä—ã –¥–ª—è production
  // –í–∞—Ä–∏–∞–Ω—Ç—ã:
  // 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Twilio TURN (–ø–ª–∞—Ç–Ω—ã–π, –Ω–æ –Ω–∞–¥–µ–∂–Ω—ã–π)
  // 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Xirsys (–ø–ª–∞—Ç–Ω—ã–π)
  // 3. –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π coturn —Å–µ—Ä–≤–µ—Ä (–±–µ—Å–ø–ª–∞—Ç–Ω–æ, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç —Å–µ—Ä–≤–µ—Ä)
  
  if (process.env.NEXT_PUBLIC_TURN_SERVER_URL) {
    config.iceServers.push({
      urls: process.env.NEXT_PUBLIC_TURN_SERVER_URL,
      username: process.env.NEXT_PUBLIC_TURN_USERNAME || '',
      credential: process.env.NEXT_PUBLIC_TURN_CREDENTIAL || '',
    })
  }

  return config
}
```

**–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ/–æ—Ç–∫—Ä—ã—Ç—ã–µ TURN —Å–µ—Ä–≤–µ—Ä—ã (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è):**
```typescript
// –í–ù–ò–ú–ê–ù–ò–ï: –ü—É–±–ª–∏—á–Ω—ã–µ TURN —Å–µ—Ä–≤–µ—Ä—ã –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è!
config.iceServers.push({
  urls: "turn:openrelay.metered.ca:80",
  username: "openrelayproject",
  credential: "openrelayproject",
})
```

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:** –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π coturn —Å–µ—Ä–≤–µ—Ä –Ω–∞ VPS –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–ª–∞—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å (Twilio, Xirsys).

### 2. HTTPS (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è getUserMedia)

**–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- getUserMedia —Ç—Ä–µ–±—É–µ—Ç HTTPS –≤ production
- –ù–∞ localhost —Ä–∞–±–æ—Ç–∞–µ—Ç HTTP, –Ω–æ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ - –Ω–µ—Ç

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. **–î–ª—è –¥–µ–ø–ª–æ—è –Ω–∞ Vercel/Netlify:**
   - HTTPS –≤–∫–ª—é—á–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   - –ù–∏—á–µ–≥–æ –¥–µ–ª–∞—Ç—å –Ω–µ –Ω—É–∂–Ω–æ

2. **–î–ª—è –¥–µ–ø–ª–æ—è –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Let's Encrypt –¥–ª—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ SSL
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å nginx/reverse proxy —Å SSL
   - –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å HTTP –Ω–∞ HTTPS

3. **–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ngrok –¥–ª—è HTTPS —Ç—É–Ω–Ω–µ–ª—è
   - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (mkcert)

### 3. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–î–æ–±–∞–≤–∏—Ç—å –≤ `.env.local` –∏ `env.template`:**

```env
# WebRTC Configuration
NEXT_PUBLIC_TURN_SERVER_URL=turn:your-turn-server.com:3478
NEXT_PUBLIC_TURN_USERNAME=your-username
NEXT_PUBLIC_TURN_CREDENTIAL=your-password

# Media Configuration (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
NEXT_PUBLIC_VIDEO_MAX_WIDTH=1920
NEXT_PUBLIC_VIDEO_MAX_HEIGHT=1080
NEXT_PUBLIC_VIDEO_MAX_FRAMERATE=60
NEXT_PUBLIC_VIDEO_MAX_BITRATE=2500000
NEXT_PUBLIC_AUDIO_SAMPLE_RATE=48000
```

### 4. –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –º–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

**–î–æ–±–∞–≤–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤:**

```typescript
// lib/utils.ts –∏–ª–∏ –Ω–æ–≤—ã–π —Ñ–∞–π–ª
export const isMobileDevice = (): boolean => {
  if (typeof window === 'undefined') return false
  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(
    navigator.userAgent
  )
}

export const isIOSDevice = (): boolean => {
  if (typeof window === 'undefined') return false
  return /iPad|iPhone|iPod/.test(navigator.userAgent)
}

export const getOptimalVideoConstraints = (): MediaTrackConstraints => {
  const isMobile = isMobileDevice()
  
  if (isMobile) {
    return {
      width: { ideal: 640, max: 1280 },
      height: { ideal: 480, max: 720 },
      frameRate: { ideal: 24, max: 30 },
      facingMode: "user",
    }
  }
  
  return {
    width: { ideal: 1280, max: 1920 },
    height: { ideal: 720, max: 1080 },
    frameRate: { ideal: 30, max: 60 },
    facingMode: "user",
  }
}
```

### 5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å–µ—Ç–∏ –∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

**–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- –ë–∞–∑–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –µ—Å—Ç—å
- –ù–æ –Ω–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–∏ –æ–±—Ä—ã–≤–µ —Å–≤—è–∑–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

```typescript
// –î–æ–±–∞–≤–∏—Ç—å –≤ use-webrtc.ts
useEffect(() => {
  if (!localStream) return

  const handleConnectionStateChange = () => {
    peerConnectionsRef.current.forEach((pc, playerId) => {
      const state = pc.getConnectionState()
      if (state === 'failed' || state === 'disconnected') {
        console.log(`[WebRTC] Connection ${state} for ${playerId}, attempting to reconnect...`)
        // –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
      }
    })
  }

  // –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Å–æ–±—ã—Ç–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
  // ...
}, [localStream])
```

### 6. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–µ–¥–ª–µ–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

**–î–æ–±–∞–≤–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ —Å–µ—Ç–∏ (Network Information API):**

```typescript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏ —Å–µ—Ç–∏ (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)
const getNetworkInfo = () => {
  if ('connection' in navigator) {
    const conn = (navigator as any).connection || (navigator as any).mozConnection || (navigator as any).webkitConnection
    if (conn) {
      return {
        effectiveType: conn.effectiveType, // 'slow-2g', '2g', '3g', '4g'
        downlink: conn.downlink, // Mbps
        rtt: conn.rtt, // ms
      }
    }
  }
  return null
}

// –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –ø–æ–¥ —Å–∫–æ—Ä–æ—Å—Ç—å —Å–µ—Ç–∏
const adaptQualityToNetwork = (networkInfo: any) => {
  if (!networkInfo) return getOptimalVideoConstraints()
  
  if (networkInfo.effectiveType === 'slow-2g' || networkInfo.effectiveType === '2g') {
    return {
      width: { ideal: 320, max: 640 },
      height: { ideal: 240, max: 480 },
      frameRate: { ideal: 15, max: 20 },
      facingMode: "user",
    }
  }
  
  if (networkInfo.effectiveType === '3g') {
    return {
      width: { ideal: 640, max: 1280 },
      height: { ideal: 480, max: 720 },
      frameRate: { ideal: 24, max: 30 },
      facingMode: "user",
    }
  }
  
  return getOptimalVideoConstraints()
}
```

---

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (WebRTC Stats API)

**–î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è:**

```typescript
// –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
const getConnectionStats = async (peerConnection: RTCPeerConnection) => {
  const stats = await peerConnection.getStats()
  const statsObj: any = {}
  
  stats.forEach((report) => {
    if (report.type === 'inbound-rtp' && report.mediaType === 'video') {
      statsObj.video = {
        bytesReceived: report.bytesReceived,
        packetsLost: report.packetsLost,
        jitter: report.jitter,
        framesDecoded: report.framesDecoded,
        framesDropped: report.framesDropped,
      }
    }
    if (report.type === 'outbound-rtp' && report.mediaType === 'video') {
      statsObj.videoSent = {
        bytesSent: report.bytesSent,
        packetsLost: report.packetsLost,
        framesEncoded: report.framesEncoded,
      }
    }
  })
  
  return statsObj
}
```

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è/–æ—Ç–∫–ª—é—á–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤:**

```typescript
// –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
navigator.mediaDevices.addEventListener('devicechange', async () => {
  const devices = await navigator.mediaDevices.enumerateDevices()
  console.log('[Media] Devices changed:', devices)
  // –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
})
```

### 3. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π:**

```typescript
const checkWebRTCSupport = () => {
  const support = {
    getUserMedia: !!(navigator.mediaDevices && navigator.mediaDevices.getUserMedia),
    RTCPeerConnection: typeof RTCPeerConnection !== 'undefined',
    getStats: typeof RTCPeerConnection !== 'undefined' && RTCPeerConnection.prototype.getStats,
    adapter: typeof adapter !== 'undefined', // webrtc-adapter
  }
  
  if (!support.getUserMedia || !support.RTCPeerConnection) {
    console.error('[WebRTC] Browser does not support WebRTC')
    return false
  }
  
  return true
}
```

### 4. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö –∫–æ–º–Ω–∞—Ç

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π:**

```typescript
// –î–ª—è –±–æ–ª—å—à–∏—Ö –∫–æ–º–Ω–∞—Ç (10+ –∏–≥—Ä–æ–∫–æ–≤) - –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –≤–∏–¥–µ–æ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤
const MAX_VIDEO_CONNECTIONS = 6 // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤–∏–¥–µ–æ —Ç–æ–ª—å–∫–æ –¥–ª—è 6 –±–ª–∏–∂–∞–π—à–∏—Ö –∏–≥—Ä–æ–∫–æ–≤
const MAX_AUDIO_CONNECTIONS = 10 // –ê—É–¥–∏–æ –¥–ª—è –≤—Å–µ—Ö

// –û—Ç–∫–ª—é—á–∞—Ç—å –≤–∏–¥–µ–æ –¥–ª—è –¥–∞–ª—å–Ω–∏—Ö –∏–≥—Ä–æ–∫–æ–≤, –Ω–æ –æ—Å—Ç–∞–≤–ª—è—Ç—å –∞—É–¥–∏–æ
```

---

## üìã –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è production –¥–µ–ø–ª–æ—è

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:
- [ ] HTTPS –≤–∫–ª—é—á–µ–Ω (–¥–ª—è getUserMedia)
- [ ] TURN —Å–µ—Ä–≤–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–¥–ª—è NAT traversal)
- [ ] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —É–ª—É—á—à–µ–Ω–∞
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö (Chrome, Firefox, Safari, Edge)
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö (iOS, Android)

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:
- [ ] –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –≤–∏–¥–µ–æ
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- [ ] –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–µ–¥–ª–µ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π
- [ ] –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –¥–ª—è –±–æ–ª—å—à–∏—Ö –∫–æ–º–Ω–∞—Ç
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ (Sentry, LogRocket –∏ —Ç.–¥.)
- [ ] CDN –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ:
- [ ] –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º webrtc-adapter –¥–ª—è –∫—Ä–æ—Å—Å–±—Ä–∞—É–∑–µ—Ä–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- [ ] SFU (Selective Forwarding Unit) –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ >20 –∏–≥—Ä–æ–∫–æ–≤)
- [ ] –í–∏–¥–µ–æ-—Å–µ—Ä–≤–µ—Ä (Janus, Kurento) –¥–ª—è –∑–∞–ø–∏—Å–∏ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–π

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

1. **TURN —Å–µ—Ä–≤–µ—Ä—ã:**
   - [Twilio STUN/TURN](https://www.twilio.com/stun-turn)
   - [Xirsys](https://xirsys.com/)
   - [coturn (—Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–π)](https://github.com/coturn/coturn)

2. **WebRTC –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:**
   - [webrtc-adapter](https://github.com/webrtcHacks/adapter) - –∫—Ä–æ—Å—Å–±—Ä–∞—É–∑–µ—Ä–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
   - [simple-peer](https://github.com/feross/simple-peer) - —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π API

3. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
   - [WebRTC Samples](https://webrtc.github.io/samples/)
   - [MDN WebRTC](https://developer.mozilla.org/en-US/docs/Web/API/WebRTC_API)

---

## üí° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

1. **–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–¥–ª—è production):**
   - HTTPS
   - TURN —Å–µ—Ä–≤–µ—Ä—ã
   - –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

2. **–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (—É–ª—É—á—à–µ–Ω–∏–µ UX):**
   - –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –≤–∏–¥–µ–æ
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

3. **–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è):**
   - Network Information API
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
   - SFU –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
